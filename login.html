<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

<input id="userId" title="아이디" type="text" name="userId" placeholder="아이디" />
<input id="password" title="비밀번호" type="text" name="password" placeholder="비밀번호" />
<div>
    <button onclick="login()">로그인</button>
</div>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
    function login(){
        const userId = $('#userId').val()
        const password = $('#password').val()
        const loginData = {"loginId": userId, "password": password}
        $.ajax({
            type : "POST",
            url : "/users/login",
            contentType: "application/json",
            data : JSON.stringify(loginData),
            success : function(result){
                const token = result.token
                // console.log(token)
                // window.location.href = "/land"
                // document.write(result.token)
                chat(token)
            },
            error : function(jqXHR, stauts, error){
                alert(`알 수 없는 에러 [ ${error} ]`)
            }
        })

        function chat(token){
            const tokens = `Bearer ${token}`
            console.log(tokens)
            $.ajax({
            type : "GET",
            headers: {"authorization": tokens},
            url : "/chat",
            contentType: "application/json",
            success : function(){
                console.log('성공')
                window.location.href = "/chat"
            },
            error : function(jqXHR, stauts, error){
                alert(`알 수 없는 에러 [ ${error} ]`)
            }
        }) 
        }


    }
</script>


</body>
</html>